
Using device: mps
Using device: mps
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:56<00:00, 10.55it/s, loss=1.84, acc=34.7]
Epoch 1:
Train Loss: 1.8386 | Train Acc: 34.68%
Val Loss: 2.0449 | Val Acc: 29.38%
Saved model with val_acc: 29.38%
----------------------------------------------------------------------
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [05:15<00:00,  9.91it/s, loss=1.77, acc=37.6]
Epoch 2:
Train Loss: 1.7663 | Train Acc: 37.58%
Val Loss: 1.8711 | Val Acc: 39.05%
Saved model with val_acc: 39.05%
----------------------------------------------------------------------
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:50<00:00, 10.74it/s, loss=1.74, acc=38.8]
Epoch 3:
Train Loss: 1.7428 | Train Acc: 38.78%
Val Loss: 1.7940 | Val Acc: 45.13%
Saved model with val_acc: 45.13%
----------------------------------------------------------------------
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [05:08<00:00, 10.13it/s, loss=1.73, acc=39.3]
Warning: Possible overfitting detected (gap: 3.01%)
Epoch 4:
Train Loss: 1.7310 | Train Acc: 39.26%
Val Loss: 1.9342 | Val Acc: 36.25%
----------------------------------------------------------------------
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [08:01<00:00,  6.50it/s, loss=1.72, acc=39.5]
Warning: Possible overfitting detected (gap: 8.30%)
Epoch 5:
Train Loss: 1.7226 | Train Acc: 39.51%
Val Loss: 1.9407 | Val Acc: 31.20%
----------------------------------------------------------------------
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:28<00:00, 11.64it/s, loss=1.72, acc=39.6]
Warning: Possible overfitting detected (gap: 5.32%)
Epoch 6:
Train Loss: 1.7204 | Train Acc: 39.61%
Val Loss: 1.8729 | Val Acc: 34.29%
----------------------------------------------------------------------
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:26<00:00, 11.71it/s, loss=1.72, acc=39.6]
Epoch 7:
Train Loss: 1.7196 | Train Acc: 39.61%
Val Loss: 1.7709 | Val Acc: 40.02%
----------------------------------------------------------------------
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:50<00:00, 10.77it/s, loss=1.72, acc=39.8]
Warning: Possible overfitting detected (gap: 5.33%)
Epoch 8:
Train Loss: 1.7165 | Train Acc: 39.79%
Val Loss: 1.9203 | Val Acc: 34.47%
----------------------------------------------------------------------
Epoch 9: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:22<00:00, 11.89it/s, loss=1.71, acc=40]
Warning: Possible overfitting detected (gap: 5.13%)
Epoch 9:
Train Loss: 1.7121 | Train Acc: 40.03%
Val Loss: 1.9205 | Val Acc: 34.91%
----------------------------------------------------------------------
Epoch 10: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:28<00:00, 11.62it/s, loss=1.7, acc=40.4]
Warning: Possible overfitting detected (gap: 0.15%)
Epoch 10:
Train Loss: 1.7044 | Train Acc: 40.37%
Val Loss: 1.8008 | Val Acc: 40.22%
----------------------------------------------------------------------
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:49<00:00, 10.81it/s, loss=1.71, acc=40.1]
Warning: Possible overfitting detected (gap: 13.33%)
Epoch 11:
Train Loss: 1.7085 | Train Acc: 40.13%
Val Loss: 1.9674 | Val Acc: 26.80%
----------------------------------------------------------------------
Epoch 12: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:23<00:00, 11.86it/s, loss=1.59, acc=45]
Warning: Possible overfitting detected (gap: 2.50%)
Epoch 12:
Train Loss: 1.5883 | Train Acc: 44.99%
Val Loss: 1.7200 | Val Acc: 42.49%
----------------------------------------------------------------------
Epoch 13: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:24<00:00, 11.79it/s, loss=1.56, acc=46]
Warning: Possible overfitting detected (gap: 5.92%)
Epoch 13:
Train Loss: 1.5588 | Train Acc: 45.96%
Val Loss: 1.7428 | Val Acc: 40.04%
----------------------------------------------------------------------
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [17:41<00:00,  2.94it/s, loss=1.55, acc=46.3]
Warning: Possible overfitting detected (gap: 6.27%)
Epoch 14:
Train Loss: 1.5457 | Train Acc: 46.27%
Val Loss: 1.8012 | Val Acc: 40.00%
----------------------------------------------------------------------
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:30<00:00, 11.54it/s, loss=1.54, acc=46.5]
Warning: Possible overfitting detected (gap: 12.56%)
Epoch 15:
Train Loss: 1.5368 | Train Acc: 46.54%
Val Loss: 1.8681 | Val Acc: 33.99%
----------------------------------------------------------------------
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [05:07<00:00, 10.15it/s, loss=1.53, acc=46.9]
Warning: Possible overfitting detected (gap: 4.30%)
Epoch 16:
Train Loss: 1.5258 | Train Acc: 46.89%
Val Loss: 1.7483 | Val Acc: 42.59%
----------------------------------------------------------------------
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 3125/3125 [04:22<00:00, 11.92it/s, loss=1.48, acc=48.7]
Warning: Possible overfitting detected (gap: 6.58%)
Epoch 17:
Train Loss: 1.4790 | Train Acc: 48.71%
Val Loss: 1.7263 | Val Acc: 42.13%
Early stopping triggered!
2024-12-04 17:35:21.239 Python[13499:1553852] +[IMKClient subclass]: chose IMKClient_Legacy
2024-12-04 17:35:21.239 Python[13499:1553852] +[IMKInputSession subclass]: chose IMKInputSession_Legacy


(.venv) (base) aryansingh@Aryans-MacBook-Air CV_CNN % python -u "/Users/aryansingh/Documents/CV_Practice/CV_CNN/src/main.py"
Using device: mps
Predicting test images: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 300000/300000 [11:42<00:00, 426.88it/s]

Predictions saved to predictions.csv


(.venv) (base) aryansingh@Aryans-MacBook-Air CV_CNN % python3.10 src/main.py

Using device: mps

Model Performance Metrics:
Overall Accuracy: 0.4596
Weighted Precision: 0.5429
Weighted Recall: 0.4596
Weighted F1-Score: 0.4684

Detailed Classification Report:
              precision    recall  f1-score   support

    airplane       0.57      0.41      0.48      5010
  automobile       0.83      0.36      0.50      4972
        bird       0.38      0.39      0.38      4953
         cat       0.22      0.53      0.31      4873
        deer       0.45      0.36      0.40      4967
         dog       0.44      0.36      0.40      4983
        frog       0.58      0.58      0.58      5042
       horse       0.71      0.41      0.52      5075
        ship       0.46      0.80      0.58      5030
       truck       0.77      0.39      0.52      5095

    accuracy                           0.46     50000
   macro avg       0.54      0.46      0.47     50000
weighted avg       0.54      0.46      0.47     50000

2024-12-04 23:12:34.127 Python[34154:2031150] +[IMKClient subclass]: chose IMKClient_Legacy
2024-12-04 23:12:34.127 Python[34154:2031150] +[IMKInputSession subclass]: chose IMKInputSession_Legacy
Validation metrics:  {'accuracy': 0.4596, 'precision': np.float64(0.5428816200624905), 'recall': np.float64(0.4596), 'f1': np.float64(0.4684058168868776), 'detailed_report': '              precision    recall  f1-score   support\n\n    airplane       0.57      0.41      0.48      5010\n  automobile       0.83      0.36      0.50      4972\n        bird       0.38      0.39      0.38      4953\n         cat       0.22      0.53      0.31      4873\n        deer       0.45      0.36      0.40      4967\n         dog       0.44      0.36      0.40      4983\n        frog       0.58      0.58      0.58      5042\n       horse       0.71      0.41      0.52      5075\n        ship       0.46      0.80      0.58      5030\n       truck       0.77      0.39      0.52      5095\n\n    accuracy                           0.46     50000\n   macro avg       0.54      0.46      0.47     50000\nweighted avg       0.54      0.46      0.47     50000\n', 'confusion_matrix': array([[2044,   33,  528,  629,   75,   40,   63,   28, 1498,   72],
       [ 541, 1779,   67,  857,   53,   27,   97,   14, 1323,  214],
       [ 262,    3, 1939, 1357,  417,  261,  419,   84,  195,   16],
       [  36,    3,  330, 2583,  224, 1037,  419,  108,  101,   32],
       [ 107,    8,  973,  881, 1800,  175,  590,  270,  124,   39],
       [  16,    4,  407, 1921,  300, 1798,  166,  303,   54,   14],
       [  16,    1,  429, 1187,  312,  127, 2917,    5,   42,    6],
       [  80,   11,  282,  955,  772,  523,  131, 2100,   70,  151],
       [ 191,   10,  148,  521,   15,    9,   67,    4, 4030,   35],
       [ 274,  297,   38,  827,   32,  116,  122,   42, 1357, 1990]])} 


1. Overall performance metrics:
   - Accuracy: 45.52%
   - Precision: 53.66%
   - Recall: 45.52%
   - F1-Score: 46.39%

2. Class-wise performance varies significantly:
   - Best performing: Automobile (precision: 82%)
   - Poorest performing: Cat (precision: 22%)
   - Most balanced: Frog (precision & recall both ~58%)

3. Still missing:
   - Confusion matrix visualization (though the code generates it)
   - Training/validation loss plots (should be saved as 'training_history.png')

These metrics suggest room for improvement, possibly through:
- Longer training
- Model architecture adjustments 
- Additional regularization
- Data augmentation refinement


